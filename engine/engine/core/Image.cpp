#include "engine/pch.h"
#include "Image.hpp"

#include "engine/graphics/utils.hpp"


////////////////////////////////////////////////////////////////
//////////////////////////// Define ////////////////////////////
////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////
//////////////////////////// Static ////////////////////////////
////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////
/////////////////////// Standalone Function /////////////////////
////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////
///////////////////////// Member Function //////////////////////
////////////////////////////////////////////////////////////////
Image::Image(): Image( 1u, 1u, eTextureFormat::RGBA16Float ) {}
Image::Image( uint width, uint height, eTextureFormat format, const void* data, size_t size )
   : mDimension( width, height ) 
   , mFormat( format )
{
   mData.Set( data, size );
}

const void* Image::At( uint x, uint y ) const
{
   uint8_t* start = (uint8_t*)Data();
   return start + (y * mDimension.x + x) * Stride();
}

void* Image::At( uint x, uint y )
{
   uint8_t* start = (uint8_t*)Data();
   return start + (y * mDimension.x + x) * Stride();
}

size_t Image::Stride() const
{
   return GetTextureFormatStride( mFormat );
}

void Image::Load( Image& image, fs::path path )
{
   image.~Image();
   new (&image)Image();
}

